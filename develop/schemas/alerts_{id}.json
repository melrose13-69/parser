{"allOf":[{"type":"object","required":["description","name"],"properties":{"name":{"type":"string","default":"Default name","minLength":1,"maxLength":64,"pattern":"^\\S+"},"description":{"type":"string"}}},{"type":"object","required":["triggeredAutoReset"],"properties":{"triggeredAutoReset":{"type":"boolean","default":false}}},{"type":"object","required":["conditionLogicalExpression","conditionLogicalExpressionEnabled"],"properties":{"conditionLogicalExpression":{"type":"string"},"conditionLogicalExpressionEnabled":{"type":"boolean","default":false}}},{"type":"object","required":["conditionTrueForPeriodEnabled","conditionTrueForPeriodPeriod","conditionTrueXTimesEnabled","conditionTrueXTimesForPeriod","conditionTrueXTimes"],"properties":{"conditionTrueForPeriodEnabled":{"type":"boolean","default":false},"conditionTrueForPeriodPeriod":{"type":"integer"},"conditionTrueXTimesEnabled":{"type":"boolean","default":false},"conditionTrueXTimesForPeriod":{"type":"integer"},"conditionTrueXTimes":{"type":"integer"}}},{"type":"object","required":["activateAfter","priority","shared"],"properties":{"activateAfter":{"type":"integer","format":"uint64"},"priority":{"type":"string","default":"critical","enum":["critical","high","low"]},"shared":{"type":"boolean","default":false}}},{"type":"object","required":["enabled"],"properties":{"enabled":{"type":"boolean","default":true}}},{"type":"object","required":["condition"],"properties":{"condition":{"minItems":1,"type":"array","items":{"type":"object","allOf":[{"type":"object","properties":{"id":{"minimum":0,"type":"integer","format":"int64"}}},{"required":["conditionId","filter1","logicalBindOperation","operation","groupby","devices","locations","units"],"type":"object","properties":{"logicalBindOperation":{"type":"string","default":"and","enum":["or","and"]},"groupby":{"type":"array","items":{"type":"object","required":["value"],"properties":{"value":{"type":"string","maxLength":45,"enum":["ip-version","src-addr","dst-addr","tos","protocol","src-port","dst-port","input-interface","output-interface","src-mask","dst-mask","src-as","dst-as","next-hop","as-path","src-country","dst-country","src-city","dst-city","src-prefix","src-prefix-length","dst-prefix","dst-prefix-length"]},"argument":{"type":"string","maxLength":45,"nullable":true}}}},"devices":{"type":"array","items":{"type":"integer","format":"int32"}},"locations":{"type":"array","items":{"type":"integer","format":"int32"}},"conditionId":{"minimum":0,"type":"integer","format":"int64"},"filter1":{"required":["aggregateFunction","filter"],"type":"object","properties":{"filter":{"type":"object","properties":{"condition":{"type":"string","enum":["and","or"]},"rules":{"type":"array","items":{"type":"object","anyOf":[{"type":"object","description":"Source addr. Format: 185.34.200.15","properties":{"key":{"type":"string","enum":["src-addr"]},"value":{"type":"array","items":{"type":"string","format":"ip-range-cidr-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination addr. Format: 204.252.0.24","properties":{"key":{"type":"string","enum":["dst-addr"]},"value":{"type":"array","items":{"type":"string","format":"ip-range-cidr-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"IP version","properties":{"key":{"type":"string","enum":["ip-version"]},"value":{"type":"string","enum":["4","6"]},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Type of service","properties":{"key":{"type":"string","enum":["tos"]},"value":{"type":"integer","minimum":0,"maximum":255},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"IP Protocol number","properties":{"key":{"type":"string","enum":["protocol"]},"value":{"type":"integer","minimum":0,"maximum":255},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"TCP/UDP source port number","properties":{"key":{"type":"string","enum":["src-port"]},"value":{"type":"integer","minimum":0,"maximum":65535},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"TCP/UDP destination port number","properties":{"key":{"type":"string","enum":["dst-port"]},"value":{"type":"integer","minimum":0,"maximum":65535},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Source VLAN","properties":{"key":{"type":"string","enum":["src-vlan"]},"value":{"type":"integer","minimum":0,"maximum":4095},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Destination VLAN","properties":{"key":{"type":"string","enum":["dst-vlan"]},"value":{"type":"integer","minimum":0,"maximum":4095},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Network mask of source prefix","properties":{"key":{"type":"string","enum":["src-mask"]},"value":{"type":"integer","minimum":0,"maximum":128},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Network mask of destination prefix","properties":{"key":{"type":"string","enum":["dst-mask"]},"value":{"type":"integer","minimum":0,"maximum":128},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Source AS Number","properties":{"key":{"type":"string","enum":["src-as"]},"value":{"description":"ASN (32bit number), range in form ASN-ASN or group name","type":"array","items":{"type":"string","format":"asn-range-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination AS Number","properties":{"key":{"type":"string","enum":["dst-as"]},"value":{"description":"ASN (32bit number), range in form ASN-ASN or group name","type":"array","items":{"type":"string","format":"asn-range-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Next hop address","properties":{"key":{"type":"string","enum":["next-hop"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Source country","properties":{"key":{"type":"string","enum":["src-country"]},"value":{"type":"object","properties":{"code":{"type":"string","maxLength":2},"name":{"type":"string"}}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination country","properties":{"key":{"type":"string","enum":["dst-country"]},"value":{"type":"object","properties":{"code":{"type":"string","maxLength":2},"name":{"type":"string"}}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Source city","properties":{"key":{"type":"string","enum":["src-city"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination city","properties":{"key":{"type":"string","enum":["dst-city"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"AS Path. .. Examples: 10001, 10054, 20064, 31000..2000","properties":{"key":{"type":"string","enum":["as-path"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Input interface Index ","properties":{"key":{"type":"string","enum":["input-interface"]},"value":{"type":"integer","minimum":0,"maximum":2147483647},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Output interface Index ","properties":{"key":{"type":"string","enum":["output-interface"]},"value":{"type":"integer","minimum":0,"maximum":2147483647},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","properties":"[Circular]"}]}}}},"aggregateFunction":{"type":"string","default":"avg","enum":["max","min","avg"]}}},"filter2":{"type":"object","allOf":[{"required":["aggregateFunction","filter","sameAsFilter1"],"type":"object","properties":{"filter":{"type":"object","properties":{"condition":{"type":"string","enum":["and","or"]},"rules":{"type":"array","items":{"type":"object","anyOf":[{"type":"object","description":"Source addr. Format: 185.34.200.15","properties":{"key":{"type":"string","enum":["src-addr"]},"value":{"type":"array","items":{"type":"string","format":"ip-range-cidr-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination addr. Format: 204.252.0.24","properties":{"key":{"type":"string","enum":["dst-addr"]},"value":{"type":"array","items":{"type":"string","format":"ip-range-cidr-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"IP version","properties":{"key":{"type":"string","enum":["ip-version"]},"value":{"type":"string","enum":["4","6"]},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Type of service","properties":{"key":{"type":"string","enum":["tos"]},"value":{"type":"integer","minimum":0,"maximum":255},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"IP Protocol number","properties":{"key":{"type":"string","enum":["protocol"]},"value":{"type":"integer","minimum":0,"maximum":255},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"TCP/UDP source port number","properties":{"key":{"type":"string","enum":["src-port"]},"value":{"type":"integer","minimum":0,"maximum":65535},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"TCP/UDP destination port number","properties":{"key":{"type":"string","enum":["dst-port"]},"value":{"type":"integer","minimum":0,"maximum":65535},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Source VLAN","properties":{"key":{"type":"string","enum":["src-vlan"]},"value":{"type":"integer","minimum":0,"maximum":4095},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Destination VLAN","properties":{"key":{"type":"string","enum":["dst-vlan"]},"value":{"type":"integer","minimum":0,"maximum":4095},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Network mask of source prefix","properties":{"key":{"type":"string","enum":["src-mask"]},"value":{"type":"integer","minimum":0,"maximum":128},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Network mask of destination prefix","properties":{"key":{"type":"string","enum":["dst-mask"]},"value":{"type":"integer","minimum":0,"maximum":128},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Source AS Number","properties":{"key":{"type":"string","enum":["src-as"]},"value":{"description":"ASN (32bit number), range in form ASN-ASN or group name","type":"array","items":{"type":"string","format":"asn-range-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination AS Number","properties":{"key":{"type":"string","enum":["dst-as"]},"value":{"description":"ASN (32bit number), range in form ASN-ASN or group name","type":"array","items":{"type":"string","format":"asn-range-group"}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Next hop address","properties":{"key":{"type":"string","enum":["next-hop"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Source country","properties":{"key":{"type":"string","enum":["src-country"]},"value":{"type":"object","properties":{"code":{"type":"string","maxLength":2},"name":{"type":"string"}}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination country","properties":{"key":{"type":"string","enum":["dst-country"]},"value":{"type":"object","properties":{"code":{"type":"string","maxLength":2},"name":{"type":"string"}}},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Source city","properties":{"key":{"type":"string","enum":["src-city"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Destination city","properties":{"key":{"type":"string","enum":["dst-city"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"AS Path. .. Examples: 10001, 10054, 20064, 31000..2000","properties":{"key":{"type":"string","enum":["as-path"]},"value":{"type":"string"},"comparisonOperator":{"type":"string","enum":["eq","noteq"]}}},{"type":"object","description":"Input interface Index ","properties":{"key":{"type":"string","enum":["input-interface"]},"value":{"type":"integer","minimum":0,"maximum":2147483647},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","description":"Output interface Index ","properties":{"key":{"type":"string","enum":["output-interface"]},"value":{"type":"integer","minimum":0,"maximum":2147483647},"comparisonOperator":{"type":"string","enum":["eq","noteq","ge","gt","lt","le"]}}},{"type":"object","properties":"[Circular]"}]}}}},"aggregateFunction":{"type":"string","default":"avg","enum":["max","min","avg"]},"sameAsFilter1":{"type":"boolean","default":false}}},{"required":["timePastOffset","timeStart","timeInfinite"],"type":"object","properties":{"timeStart":{"type":"integer","format":"uint64"},"timePastOffset":{"type":"integer","format":"uint64"},"timeInfinite":{"maximum":1,"minimum":-1,"type":"integer"}}}]},"operation":{"type":"string","default":">","enum":[">","<",">=","<=","exists","not exists"]},"rightArgument":{"type":"number","minimum":0},"units":{"type":"string","enum":["bits","octets","packets","flows"]},"unitsPrefix":{"type":"string","nullable":true,"enum":["%","K","M","G","T"]},"unitsRateUnit":{"type":"string","nullable":true,"enum":["seconds"]}}}]}}}},{"type":"object","required":["subscription"],"properties":{"subscription":{"required":["destination","events"],"properties":{"sendInterval":{"type":"integer"},"destination":{"type":"object","required":["email","slack"],"properties":{"slack":{"type":"array","items":{"type":"string"}},"email":{"type":"array","items":{"type":"string"}}}},"snooze":{"type":"array","items":{"type":"object","allOf":[{"type":"object","required":["allDay","day","from","to"],"properties":{"day":{"type":"string","enum":["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},"allDay":{"type":"boolean","default":false},"from":{"required":["hour","minute"],"type":"object","properties":{"hour":{"minimum":0,"maximum":23,"type":"integer","format":"int64"},"minute":{"minimum":0,"maximum":59,"type":"integer","format":"int64"}}},"to":{"required":["hour","minute"],"type":"object","properties":{"hour":{"minimum":0,"maximum":23,"type":"integer","format":"int64"},"minute":{"minimum":0,"maximum":59,"type":"integer","format":"int64"}}}}}]}}}}}}]}